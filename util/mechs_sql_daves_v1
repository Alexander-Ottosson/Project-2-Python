DROP TABLE IF EXISTS "user" CASCADE;
DROP TABLE IF EXISTS "contact_info" CASCADE;
DROP TABLE IF EXISTS "mech" CASCADE;
DROP TABLE IF EXISTS "picture" CASCADE;
DROP TABLE IF EXISTS "rating" CASCADE;

CREATE TABLE "user" (
  "id" SERIAL PRIMARY KEY,
  "username" varchar,
  "password" varchar,
  "firstname" varchar,
  "lastname" varchar,
  "is_pilot" boolean,
  "is_admin" boolean
);

CREATE TABLE "contact_info" (
  "id" SERIAL PRIMARY KEY,
  "user_id" integer,
  "contact" varchar
);

CREATE TABLE "mech" (
  "id" SERIAL PRIMARY KEY,
  "make" varchar,
  "model" varchar,
  "year" varchar,
  "color" varchar,
  "max_speed" float,
  "weight" float,
  "height" float,
  "description" varchar,
  "current_pilot" int REFERENCES "user"(id),
  "pilot_count" int,
  "available" boolean,
  "confidential" boolean
);

CREATE TABLE "picture" (
  "id" SERIAL PRIMARY KEY,
  "file" BYTEA,
  "mech_id" integer
);

CREATE TABLE "rating" (
  "id" SERIAL PRIMARY KEY,
  "user_id" integer,
  "mech_id" integer,
  "stars" integer,
  "review" varchar
);

SELECT * FROM "user";
SELECT * FROM "contact_info";
SELECT * FROM "mech";
SELECT * FROM "picture";
SELECT * FROM "rating";


ALTER TABLE "contact_info" ADD FOREIGN KEY ("user_id") REFERENCES "user" ("id");

-- ALTER TABLE "mech"  ADD FOREIGN KEY ("current_pilot") REFERENCES  "user" ("id");

ALTER TABLE "picture" ADD FOREIGN KEY ("mech_id") REFERENCES "mech" ("id");

ALTER TABLE "rating" ADD FOREIGN KEY ("user_id") REFERENCES "user" ("id");

ALTER TABLE "rating" ADD FOREIGN KEY ("mech_id") REFERENCES "mech" ("id");

--SAMPLE DATA

INSERT INTO "user" VALUES
(DEFAULT,'tsnark', 'password', 'Tommy', 'Snark', TRUE, TRUE),
(DEFAULT, 'scari', 'password', 'Sinji', 'Cari', TRUE, FALSE);

INSERT INTO "mech" VALUES
(
	DEFAULT,
	'Snark Industries',
	'Copper Man MK. IV',
	'2008',
	'Green',
	100,
	300,
	2,
	'A suit of mechanized armor created for counter-terrorism. This suit is fully flight capable and includes a multitude of lethal and non-lethal combatitve options',
	NULL,
	1,
	TRUE,
	FALSE
),
(
	DEFAULT,
	'Hasis',
	'Wattron',
	'2016',
	'Blue',
	800,
	1000,
	15,
	'A Mech designed for combatting threats high in the atmosphere. Fully capable of flight and weapons designed for air-to-air combat.',
	NULL,
	5,
	FALSE,
	FALSE
);